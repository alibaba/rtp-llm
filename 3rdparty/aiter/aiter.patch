--- aiter/jit/optCompilerConfig.json
+++ aiter/jit/optCompilerConfig.json
@@ -699,7 +699,7 @@
         "hip_clang_path": "os.environ.get('MHA_HIP_CLANG_PATH')",
         "blob_gen_cmd": [
             "f'{CK_DIR}/example/ck_tile/01_fmha/generate.py -d fwd --receipt 600 --output_dir {{}}'",
-            "f'{AITER_CSRC_DIR}/cpp_itfs/mha_fwd_generate.py --receipt 3 --output_dir {{}}'"
+            "f'{AITER_CSRC_DIR}/cpp_itfs/mha_fwd_generate.py --receipt 2 --output_dir {{}}'"
         ]
     },
     "module_mha_varlen_fwd": {

--- csrc/py_itfs_cu/asm_pa.cu
+++ csrc/py_itfs_cu/asm_pa.cu
@@ -115,7 +115,7 @@
     int num_heads       = Q.size(1);
     int head_size       = Q.size(2);
     int num_kv_heads    = K.size(1);
-    int block_size      = K.size(3);
+    int block_size      = K.size(2);
     const int gqa_ratio = num_heads / num_kv_heads;
 
     int dim            = head_size;


--- aiter/jit/core.py
+++ aiter/jit/core.py
@@ -168,36 +168,18 @@
 # config_env end here
 
 find_aiter = importlib.util.find_spec("aiter")
-if find_aiter is not None:
-    if find_aiter.submodule_search_locations:
-        package_path = find_aiter.submodule_search_locations[0]
-    elif find_aiter.origin:
-        package_path = find_aiter.origin
-    package_path = os.path.dirname(package_path)
-    package_parent_path = os.path.dirname(package_path)
-
-    try:
-        with open(f"{this_dir}/../install_mode", "r") as f:
-            # develop mode
-            isDevelopMode = f.read().strip() == "develop"
-    except FileNotFoundError:
-        # pip install -e
-        isDevelopMode = True
-
-    if isDevelopMode:
-        AITER_META_DIR = AITER_ROOT_DIR
-    # install mode
-    else:
-        AITER_META_DIR = os.path.abspath(f"{AITER_ROOT_DIR}/aiter_meta/")
+meta_path = os.path.abspath(f"{AITER_ROOT_DIR}/aiter_meta")
+if os.path.exists(meta_path):
+    AITER_META_DIR = meta_path
 else:
-    AITER_META_DIR = AITER_ROOT_DIR
-    logger.warning("aiter is not installed.")
+    AITER_META_DIR = os.path.abspath(AITER_ROOT_DIR)
 sys.path.insert(0, AITER_META_DIR)
 AITER_CSRC_DIR = f"{AITER_META_DIR}/csrc"
 AITER_GRADLIB_DIR = f"{AITER_META_DIR}/gradlib"
 gfx = get_gfx()
 AITER_ASM_DIR = f"{AITER_META_DIR}/hsa/{gfx}/"
-os.environ["AITER_ASM_DIR"] = AITER_ASM_DIR
+if "AITER_ASM_DIR" not in os.environ:
+    os.environ["AITER_ASM_DIR"] = AITER_ASM_DIR
 CK_3RDPARTY_DIR = os.environ.get(
     "CK_DIR", f"{AITER_META_DIR}/3rdparty/composable_kernel"
 )
 

--- aiter/__init__.py	
+++ aiter/__init__.py
@@ -77,3 +77,4 @@
 from .ops.trans_ragged_layout import *
 from .ops.sample import *
 from . import mla
+from . import paged_attn


--- aiter/ops/gemm_op_a8w8.py
+++ aiter/ops/gemm_op_a8w8.py
@@ -425,9 +425,11 @@
     WQ: Tensor,
     x_scale: Tensor,
     w_scale: Tensor,
-    dtype: torch.dtype = dtypes.bf16,
+    dtype: torch.dtype = None,
     isBpreshuffled: bool = False,
 ) -> torch.Tensor:
+    if dtype is None:
+        dtype = torch.bfloat16
     assert dtype in [
         dtypes.bf16,
         dtypes.fp16,

