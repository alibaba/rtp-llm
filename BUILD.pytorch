
cc_library(
    name = "torch",
    srcs = glob([
        "torch_root/lib/libtorch.so",
        "torch_root/lib/libtorch_cpu.so",
        "torch_root/lib/libtorch_cuda.so",
        "torch_root/lib/libtorch_python.so",
        "torch_root/lib/libtorch_nvshmem.so",
        "torch_root/lib/libc10.so",
        "torch_root/lib/libc10_cuda.so",

    ]),
    hdrs = glob([
        "torch_root/include/*.h",
        "torch_root/include/**/*.h",
        "torch_root/include/**/*.cuh",
        "torch_root/include/**/*.hpp",
    ], exclude=[
        "torch_root/include/google/**",
    ]),
    deps = [
        "@local_config_python//:python_headers",
        ":torch_api",
    ],
    strip_include_prefix = "torch_root/include",
    visibility = ["//visibility:public"],
)

cc_library(
    name = "torch_api",
    hdrs = glob([
        "torch_root/include/torch/csrc/api/include/**/*.h"
    ]),
    strip_include_prefix = "torch_root/include/torch/csrc/api/include",
    visibility = ["//visibility:public"],
)